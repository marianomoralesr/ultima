-- Add asesor_autorizado_acceso to profiles table
ALTER TABLE profiles
ADD COLUMN asesor_autorizado_acceso BOOLEAN DEFAULT FALSE;

-- Add asesor_asignado_id to profiles table
ALTER TABLE profiles
ADD COLUMN asesor_asignado_id UUID;

-- Add foreign key constraint for asesor_asignado_id
ALTER TABLE profiles
ADD CONSTRAINT fk_asesor_asignado
FOREIGN KEY (asesor_asignado_id)
REFERENCES profiles(id)
ON DELETE SET NULL; -- If an advisor is deleted, set this to NULL

-- Add last_assigned_at to profiles table for round-robin advisor assignment
ALTER TABLE profiles
ADD COLUMN last_assigned_at TIMESTAMP WITH TIME ZONE DEFAULT NOW();